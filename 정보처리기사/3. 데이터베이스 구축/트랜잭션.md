# 🌟 트랜잭션

## 트랜잭션의 개요

- 트랜잭션이란 DB 상태를 변화시키는 일련의 작업 단위이다.
- 데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산들
- 부분적으로 실행되어서는 안 된다.
- DB 시스템에서 병행 제어 및 회복 작업 시 처리되는 작업의 논리적 단위로 사용된다.
- 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업 단위로 사용된다.

## 트랜잭션의 상태

### 활동(Active)

- 트랜잭션이 실행 중인 상태

### 실패(Failed)

- 트랜잭션 실행에 오류가 발생하여 중단된 상태

### 철회(Aborted)

- 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

### 부분 완료(Partially Committed)

- 트랜잭션을 모두 성공적으로 실행한 후 Commit 연산이 실행되기 직전인 상태

### 완료(Committed)

- 트랜잭션을 모두 성공적으로 실행한 후 Commit 연산을 실행한 후의 상태

## 트랜잭션의 특성 (ACID)

> **원자성** (Atomicity)

- **_트랜잭션 실행은 모두 완료되거나 실패 시 실행 이전으로 돌아가야 한다._**
- 트랜잭션과 관련된 작업들이 모두 수행되었는지 아니면 모두 수행이 되지 않았는지를 보장하는 능력
  > **일관성** (Consistency)
- **_트랜잭션 실행 후에도 데이터베이스의 상태는 유효해야 한다._**
- 트랜잭션 실행 후에도 DB의 제약이나 규칙을 만족하며 일관성을 유지해야 한다.
  > **고립성, 격리성** (Isolation)
- **_둘 이상의 트랜잭션이 동시에 실행되는 경우 서로 독립적으로 실행되어야 한다. _**
- 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행 중에 다른 트랜잭션의 연산이 끼어들 수 없다.
- 트랜잭션 밖에 있는 어떠한 연산도 중간 단계의 데이터를 볼 수 없다.
  > **영속성** (Durability)
- **_성공적으로 완료된 트랜잭션 결과는 영구 기억 장치에 반영되어야 한다._**
- 시스템 문제, DB 일관성 체크 등을 하더라도 성공적으로 수행된 트랜잭션은 유지되어야 한다.
- 전형적으로 모든 트랜잭션은 로그로 남고 시스템 장애 발생 전 상태로 되돌릴 수 있다.
- 트랜잭션은 로그에 모든 것이 저장된 후에만 COMMIT 상태로 간주될 수 있다.
- 혹여 로그를 남기지 못한 경우 원자성에 위배되므로 해당 트랜잭션 이전으로 돌아가야 한다.
