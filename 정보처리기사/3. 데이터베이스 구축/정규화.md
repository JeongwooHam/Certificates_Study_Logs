# 🌟 정규화

## 정규화의 개요

- 정규화는 테이블을 분해하여 종속성을 줄인다.
- 함수적 종속성 등의 종속성 이론을 이용하여 잘못 설계된 관계형 스키마를 더 작은 속성의 세트로 쪼개어 바람직한 스키마로 만들어 가는 과정이다.
- 하나의 종속성이 하나의 릴레이션에 표현될 수 있도록 분해해가는 과정
- 정규형에는 제1정규형, 제2정규형, 제3정규형, BCNF형, 제4정규형, 제5정규형이 있으며, 차수가 높아질수록 만족시켜야 할 제약 조건이 늘어난다.
- 데이터베이스의 논리적 설계 단계에서 수행한다.
- 논리적 처리 및 품질에 큰 영향을 미친다.
- 정규화된 데이터 모델은 일관성, 정확성, 단순성, 비중복성, 안정성 등을 보장한다.

## 정규화의 목적

- 데이터 구조의 안정성 및 무결성을 유지한다.
- 어떠한 릴레이션이라도 데이터베이스 내에서 표현 가능하게 만든다.
- 효과적인 검색 알고리즘을 생성할 수 있다.
- 데이터 중복을 배제하여 이상(Anomaly)의 발생 방지 및 자료 저장 공간의 최소화가 가능하다.
- 데이터 삽입 시 릴레이션을 재구성할 필요성을 줄인다.
- 데이터 모형의 단순화가 가능하다.
- 속성의 배열 상태 검증이 가능하다.
- 개체와 속성의 누락 여부 확인이 가능하다.
- 자료 검색과 추출의 효율성을 추구한다.

## 이상

- 정규화를 거치지 않으면 데이터베이스 내에 데이터들이 불필요하게 중복되어 릴레이션 조작 시 발생하게 되는 예기치 못한 곤란한 현상

### 이상의 종류

> **삽입 이상**

- 릴레이션에 데이터를 삽입할 때 의도와는 상관없이 원하지 않은 값들도 함께 삽입되는 현상

> **삭제 이상**

- 릴레이션에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는 연쇄가 일어나는 현상

> **갱신 이상**

- 릴레이션에서 튜플에 있는 속성값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 모순이 생기는 현상

## 정규형

- 정규화된 결과
- 제1정규형, 제2정규형, 제3정규형, BCNF형, 제4정규형, 제5정규형
- 차수가 높아질수록 만족시켜야 할 제약 조건이 늘어난다.

> 제1정규형 (1NF)

- 릴레이션에 속하는 속성의 속성 값이 모두 원자값만으로 구성된 것

> 제2정규형 (2NF)

- 제1정규형이면서 기본키(PK)에 속하지 않은 속성 모두가 기본키에 완전 함수 종속인 정규형

> 제3정규형 (3NF)

- 제2정규형이면서 이행적 함수 종속성을 제거한 정규형

> BCNF (Boyce and Codd Normal Form)

- 제3정규형을 조금 더 강화시킨 개념. 강한 제3정규형

## 정규화 과정

![image](https://github.com/JeongwooHam/FE_Study_Logs/assets/123251211/7b6a4959-14b1-479d-9397-36a6bbda3321)

> 비정규 릴레이션 ➡️ 1NF

- 원자 값이 아닌 도메인 분해하여 특정 릴레이션에 속한 모든 도메인이 원자값으로만 되어 있도록 설계하는 과정
- 비정규 릴레이션: 여러 개의 값이 들어와 원자성을 가지지 못한 경우
- 예: A에 대한 연락처 2개
  - -> 집 전화 1개 / 휴대폰 1개로 분리

> 1NF ➡️ 2NF

- 부분적 함수 종속 제거
- 특정 릴레이션이 제1 정규화에 속하고 PK에 속하지 않는 모든 속성이 PK에 완전한 함수적 종속이면 충족한다.
- 예: 기본키(학번, 과목번호) / 학년 / 성적 -
  - -> 기본키(학번) / 과목번호 / 성적, 기본키(학번) / 학년

> 2NF ➡️ 3NF

- 이행적 함수 종속 제거
  - 이행적 함수 종속: A -> B이고 B -> C일 때 A -> C를 만족하는 관계
- 특정 릴레이션이 제2 정규화 되어 있으며 PK에 속하지 않는 모든 속성이 기본키에 이행적 함수 종속이 아닌 상태의 관계
- 예 : 학번 -> 지도교수 -> 학과
  - -> 학번 (PK) / 지도교수 (FK), 지도교수(PK) / 학과

> 3NF ➡️ BCNF

- 결정자이면서 후보키가 아닌 것 제거
- 아래의 예시에서 삽입 이상(학생의 과목 추가 시 불필요한 교수 정보도 추가), 갱신 이상(교수 변경 시 수강생들의 튜플을 모두 검색해 수정해야 함), 삭제 이상(학생이 삭제될 경우 과목에 대한 담당 교수 정보가 사라질 수 있음)이 발생할 수 있다.

| 학번 |     과목     |  교수  |
| :--: | :----------: | :----: |
| 100  | 데이터베이스 | ㅁㅁㅁ |
| 100  |   자료구조   | ㅇㅇㅇ |
| 200  |   네트워크   | ㅂㅂㅂ |
| 300  |   네트워크   | ㅂㅂㅂ |

- (학번 / 교수, 과목 / 교수)의 형태로 수정할 수 있다.

> BCNF ➡️ 4NF

- 다치 종속 제거

> 4NF ➡️ 5NF

- 조인 종속성 이용

### 이행적 종속 관계

- Transitive Dependency
- A → B이고 B → C일 때 A → C를 만족하는 관계를 의미한다.

### 함수적 종속

- Functional Dependency
- 데이터들이 어떤 기준값에 의해 종속되는 것을 의미한다.
- 예를 들어 <수강> 릴레이션이 (학번, 이름, 과목명)으로 되어 있을 때, ‘학번’이 결정되면 ‘과목명’에 상관없이 ‘학번’에는 항상 같은 ‘이름’이 대응된다.
  - ‘학번’에 따라 ‘이름’이 결정될 때 ‘이름’을 ‘학번’에 함수 종속적이라고하며 ‘학번 → 이름’과 같이 쓴다.
- 어떤 릴레이션 R에서 X와 Y를 각각 R의 애트리뷰트 집합의 부분 집합이라고 할 경우 애트리뷰트 X의 값 각각에 대해 시간에 관계없이 항상 애트리뷰트 Y의 값이 오직 하나만 연관되어 있을 때 Y는 X에 함수 종속
  - X의 값을 알면 Y의 값을 바로 식별할 수 있고 X의 값에 의해 Y의 값이 달라진다.
  - X는 결정자, Y는 종속자 (`X -> Y`와 같이 표현한다.)

## 반정규화

### 반정규화의 개요

- 시스템의 성능 향상, 개발 및 운영의 편의성 등을 위해 정규화된 데이터 모델을 통합, 중복, 분리하는 과정
- 의도적으로 정규화 원칙을 위배하는 행위
- 시스템의 성능이 향상되고 관리 효율성은 증가하지만 데이터의 일관성 및 정합성이 저하될 수 있다.
- 과도한 반정규화는 오히려 성능을 저하시킬 수 있다.
- 반정규화를 위해서는 사전에 데이터의 일관성과 무결성을 우선으로 할지, 데이터베이스의 성능과 단순화를 우선으로 할지를 결정해야 한다.

### 반정규화 방법

> **테이블 통합**

- 두 개의 테이블이 조인(Join)되는 경우가 많아 하나의 테이블로 합쳐 사용하는 것이 성능 향상에 도움이 될 경우 수행함
- 두 개의 테이블에서 발생하는 프로세스가 동일하게 자주 처리되는 경우, 두 개의 테이블을 이용하여 항상 조회를 수행하는 경우 테이블 통합을 고려함

> **테이블 분할**

- 테이블을 수직 또는 수평으로 분할하는 것
- **수평** 분할(Horizontal Partitioning)
  - 레코드(Record)를 기준으로 테이블을 분할하는 것
- **수직** 분할(Vertical Partitioning)
  - 하나의 테이블에 속성이 너무 많을 경우 속성을 기준으로 테이블을 분할하는 것

> **중복 테이블 추가**

- 여러 테이블에서 데이터를 추출해서 사용해야 하거나 다른 서버에 저장된 테이블을 이용해야 하는 경우 중복 테이블을 추가하여 작업의 효율성을 향상시킬 수 있음
- 중복 테이블 추가 방법
  - 집계 테이블의 추가
  - 진행 테이블의 추가
  - 특정 부분만을 포함하는 테이블의 추가

> **중복 속성 추가**

- 조인해서 데이터를 처리할 때 데이터를 조회하는 경로를 단축하기 위해 자주 사용하는 속성을 하나 더 추가하는 것
